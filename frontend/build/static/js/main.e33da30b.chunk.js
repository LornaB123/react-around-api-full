(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{31:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),o=n.n(c),r=n(20),s=n.n(r),i=n(8),l=(n(31),n(24)),u=n(2),j=n(3),d=Object(c.createContext)();var p=function(e){var t=Object(c.useState)(!1),n=Object(u.a)(t,2),o=n[0],r=n[1];return Object(a.jsxs)("header",{className:"header ".concat(o&&"header_open"),children:[Object(a.jsx)("img",{src:e.logo,alt:"logo",className:"logo"}),Object(a.jsxs)("div",{className:"header__wrapper ".concat(o&&"header__wrapper_open"),children:[Object(a.jsx)("p",{className:"header__email",children:e.email}),Object(a.jsx)("button",{className:"header__log",onClick:function(){localStorage.removeItem("jwt"),e.handleLog()},children:"Log out"})]}),Object(a.jsx)("button",{className:"header__icon ".concat(o&&"header__icon_cross"),onClick:function(){r(!o)}})]})};var b=function(e){var t=e.card,n=e.onCardDelete,o=e.onCardClick,r=e.onCardLike,s=Object(c.useContext)(d),i=t.owner._id===s._id,l="elements__trash ".concat(i?"elements__trash_visible":"elements__trash"),u=t.likes.some((function(e){return e._id===s._id})),j="elements__favorite ".concat(u?"elements__favorite_selected":"elements__favorite");return Object(a.jsxs)("figure",{className:"elements__element",children:[Object(a.jsx)("img",{className:"elements__element-pic",alt:"card",onClick:function(){return o(t)},src:t&&t.link}),Object(a.jsx)("figcaption",{className:"elements__caption",children:t.name}),Object(a.jsxs)("div",{className:"elements__favorite-container",children:[Object(a.jsx)("button",{className:j,onClick:function(){return r(t)},type:"button","aria-label":"Like"}),Object(a.jsx)("p",{className:"elements__likes",children:t.likes.length})]}),Object(a.jsx)("button",{className:l,type:"button",onClick:function(){return n(t)},"aria-label":"Delete"})]})};var h=function(e){var t=e.cards,n=e.onEditAvatar,o=e.onEditProfile,r=e.onAddPlace,s=e.onCardDelete,i=e.onCardClick,l=e.onCardLike,u=Object(c.useContext)(d);return Object(a.jsxs)("main",{className:"content",children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsxs)("div",{className:"profile__avatar",children:[Object(a.jsx)("img",{className:"profile__image",src:u.avatar,alt:u.avatar}),Object(a.jsx)("button",{onClick:n,className:"profile__image-edit",type:"button","aria-label":"Edit Avatar"})]}),Object(a.jsxs)("div",{className:"profile__info",children:[Object(a.jsx)("h1",{className:"profile__info-title",children:u.name}),Object(a.jsx)("button",{className:"profile__edit-button",onClick:o,"aria-label":"Edit Profile"}),Object(a.jsx)("p",{className:"profile__info-subtitle",children:u.about})]}),Object(a.jsx)("button",{className:"profile__add-button",onClick:r,"aria-label":"Add"})]}),Object(a.jsx)("section",{className:"elements",children:Object(a.jsx)(a.Fragment,{children:t.map((function(e){return Object(a.jsx)(b,{card:e,onCardDelete:s,onCardClick:i,onCardLike:l},e._id)}))})})]})};var m=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsx)("p",{className:"footer__info",children:"\xa9 2020 Around The U.S."})})};var _=function(e){var t=e.card,n=e.isOpen,c=e.onClose;return Object(a.jsx)("div",{className:"popup popup_type_image ".concat(n?"popup_open":""),children:Object(a.jsxs)("div",{className:"popup_container_type_image",children:[Object(a.jsx)("img",{alt:"Popup",className:"popup__image",src:t&&t.link}),Object(a.jsx)("h3",{className:"popup__caption",children:t.name}),Object(a.jsx)("button",{className:"popup__close-button",onClick:c,type:"reset","aria-label":"Close Form"})]})})};var f=function(e){var t=e.name,n=e.onSubmit,c=e.onClose,o=e.isOpen,r=e.buttonText,s=e.children,i=e.title;return Object(a.jsx)("div",{className:"popup popup_".concat(t," ").concat(o?"popup_open":""),onClick:c,children:Object(a.jsx)("div",{className:"popup__container",children:Object(a.jsxs)("form",{action:"#",className:"popup__form ".concat(t,"-form"),onSubmit:n,noValidate:!0,children:[Object(a.jsx)("h2",{className:"popup__title",children:i}),s,Object(a.jsx)("button",{className:"popup__save",type:"submit","aria-label":"Save",children:r}),Object(a.jsx)("button",{className:"popup__close-button",onClick:c,type:"reset","aria-label":"Close Form"})]})})})};var O=function(e){var t=Object(c.useState)(" "),n=Object(u.a)(t,2),o=n[0],r=n[1],s=Object(c.useState)(" "),i=Object(u.a)(s,2),l=i[0],j=i[1],p=Object(c.useContext)(d);return Object(c.useEffect)((function(){r(p.name),j(p.about)}),[p]),Object(a.jsxs)(f,{name:"type_edit",title:"Edit Profile",buttonText:"Save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:o,about:l})},children:[Object(a.jsx)("input",{id:"profile-name",type:"text",name:"name",value:o||"",className:"popup__input popup__input_type_name",onChange:function(e){r(e.target.value)},placeholder:"Jacques Cousteau",required:!0,maxLength:"40",minLength:"2"}),Object(a.jsx)("span",{id:"profile-name-error",className:"popup__error"}),Object(a.jsx)("input",{id:"profile-text",type:"text",name:"about",className:"popup__input popup__input_type_job",value:l||"",onChange:function(e){j(e.target.value)},placeholder:"Explorer",required:!0,maxLength:"200",minLength:"2"}),Object(a.jsx)("span",{id:"profile-text-error",className:"popup__error"})]})};var g=function(e){var t=e.isOpen,n=e.onClose,o=e.onUpdateAvatar,r=Object(c.useRef)();return Object(a.jsxs)(f,{name:"type_avatar",value:r||"",title:"Change Profile Picture",buttonText:"Save",isOpen:t,onClose:n,onUpdateAvatar:o,onSubmit:function(e){e.preventDefault(),o(r.current.value)},children:[Object(a.jsx)("input",{id:"avatar-URL",type:"url",name:"avatarURL",className:"popup__input popup__input_type_avatar-URL",minLength:"2",ref:r}),Object(a.jsx)("span",{id:"avatar-URL-error",className:"popup__error"})]})};var v=function(e){var t=e.isOpen,n=e.onClose,o=e.onAddPlace,r=Object(c.useState)(""),s=Object(u.a)(r,2),i=s[0],l=s[1],j=Object(c.useState)(""),d=Object(u.a)(j,2),p=d[0],b=d[1];return Object(a.jsxs)(f,{name:"type_add-card",title:"New Place",buttonText:"Create",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),o({name:i,link:p}),b(""),l("")},children:[Object(a.jsx)("input",{id:"card-title",type:"text",name:"card-title",value:i,onChange:function(e){l(e.target.value)},className:"popup__input popup__input_type_title",placeholder:"Title",required:!0,maxLength:"30",minLength:"2"}),Object(a.jsx)("span",{id:"card-title-error",className:"popup__error"}),Object(a.jsx)("input",{id:"card-url",type:"url",name:"card-link",value:p,onChange:function(e){b(e.target.value)},className:"popup__input popup__input_type_link",placeholder:"Image Link",required:!0}),Object(a.jsx)("span",{id:"card-url-error",className:"popup__error"})]})};var x=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),o=n[0],r=n[1],s=Object(c.useState)(""),l=Object(u.a)(s,2),j=l[0],d=l[1];return Object(a.jsxs)("div",{className:"login",children:[Object(a.jsxs)("div",{className:"login__container",children:[Object(a.jsx)("img",{src:e.logo,alt:"logo",className:"logo"}),Object(a.jsx)(i.b,{to:"/signup",className:"login__link",children:"Sign up"})]}),Object(a.jsxs)("form",{action:"#",className:"login__form",onSubmit:function(t){t.preventDefault(),e.handleAuth(j,o),r(""),d("")},children:[Object(a.jsx)("p",{className:"login__title",children:"Log in"}),Object(a.jsx)("input",{type:"email",name:"email",placeholder:"Email",className:"login__input",value:o,onChange:function(e){r(e.target.value)},required:!0}),Object(a.jsx)("input",{type:"password",name:"password",placeholder:"Password",className:"login__input",value:j,onChange:function(e){d(e.target.value)},minLength:4,maxLength:12,required:!0}),Object(a.jsx)("button",{className:"login__submit",type:"submit",children:"Log in"}),Object(a.jsx)(i.b,{to:"/signup",className:"login__link login__note",children:"Not a member yet? Sign up here!"})]})]})},N=n(12),C=n(13);var k=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),o=n[0],r=n[1],s=Object(c.useState)(""),l=Object(u.a)(s,2),j=l[0],d=l[1],p=Object(c.useState)({}),b=Object(u.a)(p,2),h=b[0],m=b[1];return Object(a.jsxs)("div",{className:"login",children:[Object(a.jsxs)("div",{className:"login__container",children:[Object(a.jsx)("img",{src:e.logo,alt:"logo",className:"logo"}),Object(a.jsx)(i.b,{to:"/signin",className:"login__link",children:"Log in"})]}),Object(a.jsxs)("form",{action:"#",className:"login__form",onSubmit:function(t){t.preventDefault(),Object.values(h).filter((function(e){return e})).length||(e.handleRegister(j,o),r(""),d(""))},children:[Object(a.jsx)("p",{className:"login__title",children:"Sign up"}),Object(a.jsx)("input",{type:"email",name:"email",placeholder:"Email",className:"login__input",value:o,onChange:function(e){r(e.target.value),m(Object(C.a)(Object(C.a)({},h),{},Object(N.a)({},e.target.name,e.target.validationMessage)))},required:!0}),Object(a.jsx)("input",{type:"password",name:"password",placeholder:"Password",className:"login__input",value:j,onChange:function(e){d(e.target.value),m(Object(C.a)(Object(C.a)({},h),{},Object(N.a)({},e.target.name,e.target.validationMessage)))},minLength:4,maxLength:12,required:!0}),Object(a.jsx)("button",{className:"login__submit",type:"submit",children:"Sign up"}),Object(a.jsx)(i.b,{to:"/signin",className:"login__link login__note",children:"Already a member? Log in here!"})]})]})};var y=function(e){var t=e.registered,n=e.isOpen,c=e.toggle;return Object(a.jsx)("div",{className:"tip ".concat(n&&"tip_visible"),onClick:function(e){return e.target===e.currentTarget&&c()},children:Object(a.jsxs)("div",{className:"tip__wrapper",children:[Object(a.jsx)("div",{className:t?"tip__icon":"tip__icon tip__icon_error"}),Object(a.jsx)("p",{className:"tip__text",children:t?"Success! You have now been registered.":"Oops, something went wrong! Please try again."}),Object(a.jsx)("div",{className:"tip__close",onClick:c})]})})},S=n.p+"static/media/logo.4e8e0a1d.svg",L=n(22),P=n(23),U=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(L.a)(this,e),this._baseUrl=n,this._headers=a}return Object(P.a)(e,[{key:"getInitialCards",value:function(){return fetch(this._baseUrl+"/cards/",{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error"+e.statusText)}))}},{key:"getUserInfo",value:function(){return fetch(this._baseUrl+"/users/me/",{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error"+e.statusText)}))}},{key:"getAppInfo",value:function(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}},{key:"addCard",value:function(e){var t=e.name,n=e.link;return fetch(this._baseUrl+"/cards/",{headers:this._headers,method:"POST",body:JSON.stringify({name:t,link:n})}).then((function(e){return e.ok?e.json():Promise.reject("Error"+e.statusText)})).catch((function(e){return console.log(e)}))}},{key:"removeCard",value:function(e){return fetch(this._baseUrl+"/cards/"+e,{headers:this._headers,method:"DELETE"}).then((function(e){return e.ok?e.json():Promise.reject("Error"+e.statusText)}))}},{key:"addLike",value:function(e){return fetch(this._baseUrl+"/cards/likes/"+e,{headers:this._headers,method:"PUT"}).then((function(e){return e.ok?e.json():Promise.reject("Error"+e.statusText)}))}},{key:"removeLike",value:function(e){return fetch(this._baseUrl+"/cards/likes/"+e,{headers:this._headers,method:"DELETE"}).then((function(e){return e.ok?e.json():Promise.reject("Error"+e.statusText)}))}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;return fetch(this._baseUrl+"/users/me/",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("Error"+e.statusText)}))}},{key:"setUserAvatar",value:function(e){return fetch(this._baseUrl+"/users/me/avatar/",{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("Error"+e.statusText)}))}}]),e}())({baseUrl:"http://localhost: 3001"}),E="http://localhost:3000",T=n(25);var w=function(e){e.component;var t=Object(T.a)(e,["component"]);return Object(a.jsx)(j.b,{exact:!0,path:t.path,children:t.loggedIn?t.children:Object(a.jsx)(j.a,{to:"/signin"})})};var A=function(){var e=Object(c.useState)(!1),t=Object(u.a)(e,2),n=t[0],o=t[1],r=Object(c.useState)(!1),s=Object(u.a)(r,2),i=s[0],b=s[1],N=Object(c.useState)(!1),C=Object(u.a)(N,2),L=C[0],P=C[1],T=Object(c.useState)(!1),A=Object(u.a)(T,2),I=A[0],D=A[1],q=Object(c.useState)(!1),J=Object(u.a)(q,2),R=J[0],B=J[1],F=Object(c.useState)(""),M=Object(u.a)(F,2),H=M[0],W=M[1],Y=Object(c.useState)({}),z=Object(u.a)(Y,2),G=z[0],V=z[1],$=Object(c.useState)([]),K=Object(u.a)($,2),Q=K[0],X=K[1],Z=Object(c.useState)(!1),ee=Object(u.a)(Z,2),te=ee[0],ne=ee[1],ae=Object(c.useState)(""),ce=Object(u.a)(ae,2),oe=ce[0],re=ce[1],se=Object(c.useState)(!1),ie=Object(u.a)(se,2),le=ie[0],ue=ie[1],je=Object(c.useState)(!1),de=Object(u.a)(je,2),pe=de[0],be=de[1],he=Object(j.f)();function me(){o(!1),b(!1),P(!1),D(!1),B(!1)}function _e(e){e.target===e.currentTarget&&me()}function fe(){be(!pe)}function Oe(e,t){(function(e,t){return fetch("".concat(E,"/signin"),{method:"POST",referrerPolicy:"no-referrer",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then((function(e){return e.json()}))})(e,t).then((function(e){var n=e.token;if(n)return localStorage.setItem("jwt",n),ne(!0),void re(t);ue(!1),fe()})).catch((function(e){return console.log(e)}))}return Object(c.useEffect)((function(){U.getInitialCards().then((function(e){X(e)})).catch((function(e){return console.log(e)}))}),[]),Object(c.useEffect)((function(){U.getUserInfo().then((function(e){V(e)})).catch((function(e){return console.log(e)}))}),[]),Object(c.useEffect)((function(){var e,t=localStorage.getItem("jwt");if(t)return(e=t,fetch("".concat(E,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))).then((function(e){var t=e.data;if(t)return ne(!0),void re(t.email);ne(!1)})).catch((function(e){return console.log(e)}));ne(!1)}),[]),Object(a.jsx)("div",{className:"body",children:Object(a.jsxs)(d.Provider,{value:G,children:[Object(a.jsx)(j.b,{path:"/signin",children:te?Object(a.jsx)(j.a,{to:"/"}):Object(a.jsx)(x,{logo:S,handleAuth:Oe})}),Object(a.jsx)(j.b,{path:"/signup",children:te?Object(a.jsx)(j.a,{to:"/"}):Object(a.jsx)(k,{logo:S,handleRegister:function(e,t){return function(e,t){return fetch("".concat(E,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then((function(e){return e.json()}))}(e,t).then((function(n){if(n.data)return ne(!0),he.push("/signin"),Oe(e,t),ue(!0),void fe();ue(!1),fe()})).catch((function(e){return console.log(e)}))}})}),Object(a.jsxs)(w,{path:"/",loggedIn:te,children:[Object(a.jsx)(p,{logo:S,email:oe,handleLog:function(){ne(!te)}}),Object(a.jsx)(h,{cards:Q,onEditAvatar:function(e){o(!0)},onEditProfile:function(e){b(!0)},onAddPlace:function(e){P(!0)},onCardDelete:function(e){U.removeCard(e._id).then((function(){var t=Q.filter((function(t){return t._id!==e._id}));X(t)})).catch((function(e){return console.log(e)}))},onCardClick:function(e){W(e),B(!0)},onCardLike:function(e){(!1===e.likes.some((function(e){return e._id===G._id}))?U.addLike(e._id):U.removeLike(e._id)).then((function(t){var n=Q.map((function(n){return n._id===e._id?t:n}));X(n)})).catch((function(e){return console.log(e)}))},onCloseButtons:me}),Object(a.jsx)(m,{}),Object(a.jsx)(g,{isOpen:n,onClose:_e,onUpdateAvatar:function(e){U.setUserAvatar(e).then((function(e){V(e)})).catch((function(e){return console.log(e)})).finally((function(){return me()}))}}),Object(a.jsx)(O,{isOpen:i,onClose:_e,onUpdateUser:function(e){var t=e.name,n=e.about;U.setUserInfo({name:t,about:n}).then((function(e){V(e)})).catch((function(e){return console.log(e)})).finally((function(){return me()}))}}),Object(a.jsx)(v,{isOpen:L,onClose:_e,onAddPlace:function(e){var t=e.name,n=e.link;U.addCard({name:t,link:n}).then((function(e){X([e].concat(Object(l.a)(Q)))})).catch((function(e){return console.log(e)})).finally((function(){return me()}))}}),Object(a.jsx)(f,{name:"type_delete-card",title:"Are you sure?",buttonText:"Yes",isOpen:I,onClose:_e}),Object(a.jsx)(_,{card:H,isOpen:R,onClose:_e})]}),Object(a.jsx)(j.b,{path:"/",children:te?Object(a.jsx)(j.a,{to:"/"}):Object(a.jsx)(j.a,{to:"/signin"})}),Object(a.jsx)(y,{isOpen:pe,registered:le,toggle:fe})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(i.a,{children:Object(a.jsx)(A,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.e33da30b.chunk.js.map